#!/bin/sh

export TBEDP_TEST_DATA_SEM=../../data/towninfo-test.sem
export TBEDP_TEST_DATA_ASR=../../data/towninfo-test.asr
export TBEDP_OUT_PICKLE=rules.pickle
export TBEDP_OUT_SEM_HYP=rules.sem.hyp
export TBEDP_OUT_ASR_HYP=rules.asr.hyp
export TBEDP_OUT_DICT=rules.pckl-dict

date
  
time ../../src/tbedp-decoder.py -v \
  --testData=$TBEDP_TEST_DATA_SEM \
  --inPickle=$TBEDP_OUT_PICKLE \
  --outSem=$TBEDP_OUT_SEM_HYP \
  --inDict=$TBEDP_OUT_DICT

time ../../src/tbedp-decoder.py -v \
  --testData=$TBEDP_TEST_DATA_ASR \
  --inPickle=$TBEDP_OUT_PICKLE \
  --outSem=$TBEDP_OUT_ASR_HYP \
  --inDict=$TBEDP_OUT_DICT
  
#../../bin/cuedSemScore.pl $TBEDP_OUT_SEM_HYP $TBEDP_TEST_DATA_SEM
../../bin/cuedSemScore.pl $TBEDP_OUT_SEM_HYP $TBEDP_TEST_DATA_SEM > $TBEDP_OUT_SEM_HYP.rslt
../../bin/cuedSemScore.pl $TBEDP_OUT_ASR_HYP $TBEDP_TEST_DATA_ASR > $TBEDP_OUT_ASR_HYP.rslt

date

echo $1 > rules.settings
env | grep TBEDP | sort >> rules.settings